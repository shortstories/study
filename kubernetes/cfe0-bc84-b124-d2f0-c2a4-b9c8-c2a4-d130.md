# 쿠버네티스 마스터

## 분산 시스템 디자인 패턴

### Sidecar pattern

메인 어플리케이션 컨테이너 + 사이드카 컨테이너

보통 메인 어플리케이션은 사이드카 컨테이너의 유무에 영향받지 않도록 해야됨. 그에 따라 사이드카 컨테이너가 수행하는 부분에 수정사항이 발생해도 메인 어플리케이션 컨테이너는 수정하지 않고 배포할 수 있음. 그리고 사이드카 컨테이너가 수행하는 작업이 메인 어플리케이션에게 부하를 주지도 않음.

ex\) log aggregation side car container. 메인 어플리케이션은 로컬에다가 로그를 파일로 쌓고 사이드카 컨테이너는 그 파일을 읽어서 로그 서버로 보내는 역할만 수행. 메인 어플리케이션은 사이드카 컨테이너가 있던지 없던지 정상적으로 작업 수행

### Ambassador pattern

메인 어플리케이션 컨테이너 + 엠베서더 컨테이너

외부 서비스를 마치 로컬에 있는 것 처럼 구성하는 패턴. 외부의 서비스를 참조해서 각종 작업을 대행해주는 로컬 엠베서더 컨테이너를 하나 띄워놓고 메인 어플리케이션 컨테이너는 모두 이 로컬 컨테이너를 통해서 작업을 수행하는 방식. 이렇게 하면 위와 마찬가지로 서비스 구성이 바뀌거나 했을 때 메인 어플리케이션 변경 없이 엠베서더 컨테이너만 갈아끼우면 된다는 장점이 생김. 뿐만 아니라 로컬 엠베서더 컨테이너에 failover나 load balancing같은 추가기능을 넣을 수 있고 마찬가지로 메인 어플리케이션에 관계없이 변경이 가능.

ex\) Consul을 이런 식으로 구성할 수 있는데, 실제 Consul 서비스는 외부에 Server모드로 3대를 띄워서 쿼럼을 구성해놓고, 로컬에다가 Client모드로 1대 띄워서 외부 쿼럼을 참조하도록 세팅. 이렇게 하면 consul에다가 kv 요청같은걸 보낼 때 localhost:8500으로 쏘기만 하면 외부 쿼럼의 존재유무를 몰라도 원하는 대로 동작하게 할 수 있음.

### Adapter pattern

메인 어플리케이션 컨테이너 -&gt; 어뎁터 패턴





