# Kubernetes

## Cluster

* 여러 컴퓨터를 묶어서 하나의 단위로 다룰 수 있게 만들어주는 개념
* 컨테이너화된 어플리케이션을 어느 누구에게 배포하겠다고 지시할 필요 없이 그냥 클러스터에다가 바로 배포할 수 있게 도와줌
* 쿠버네티스는 여러 클러스터 사이에서 효율적으로 컨테이너를 분배하고 스케쥴링할 수 있도록 자동화함.

* Master + Node
* ![](/assets/clusterDiagram.png)

### Master

클러스터를 관리하는 역할. 어플리케이션 스케일링, 스케쥴링 등 모든 관리 작업들을 수행

### Node

쿠버네티스 클러스터의 워커 머신으로 동작하는 VM 또는 물리 컴퓨터. 각 노드는 클러스터로써 동작하기 위해 Kubelet이라는 쿠버네티스의 agent를 가짐. 그리고 Docker나 rkt같은 컨테이너 프로그램도 가짐. 하나의 클러스터는 적어도 3개 이상의 노드를 포함하고 있어야 함.



사용자가 새로운 어플을 쿠버네티스에 배포하려고 하면, 먼저 마스터에게 어플 컨테이너를 시작하라고 명령을 내림. 그러면 마스터는 클러스터의 노드에서 새로운 컨테이너를 시작하도록 스케쥴링을 함. 노드는 마스터와 쿠버네이츠 API를 통해서 서로 통신하며, 필요하다면 직접 API를 호출해서 동작하게 만들 수도 있음.

## Deployment

Docker에 container가 있다면 쿠버네티스에는 Deployment가 있다고 보면 딱 이해하기 쉬울 듯 함. 마치 `docker run` 하듯이 `kubectl run` 을 하고, 각각의 Deployment는 자신의 이름과 바탕이 되는 컨테이너 이미지 주소를 가지게 됨.

일단 쿠버네티스 클러스터 안에서 돌아가고있는 Pods는 기본적으로 외부로 노출되지않고 내부 통신만 가능함. 그러므로 외부로 노출하려면 좀 몇 가지 방법을 써야하는데, 그중 하나는 `kubectl proxy` 말 그대로 클러스터 안쪽으로 리버스 프록싱을 해줌. 

## Pods

Pod는 쿠버네티스가 하나 또는 하나 이상의 컨테이너들을 추상화해서 부르는 단위이다. 또한 이 컨테이너들이 공유하는 자원도 포함하는데, 그 자원의 목록은 다음과 같다.

1. 공유 저장소인 Volume
2. 하나의 단일 클러스터 IP 주소
3. 컨테이너 이미지 버전이라던가 포트같은 기타 정보들





